<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Shutdown App</title>

<style>
body{font-family:Segoe UI;background:#f1f3f6;margin:0}
header{background:#1f3a5f;color:#fff;padding:14px;text-align:center}
.card{background:#fff;margin:12px;padding:14px;border-radius:10px}
button{padding:10px 14px;border:0;border-radius:8px;background:#1f3a5f;color:#fff}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;border-bottom:1px solid #ddd;font-size:14px}

/* POPUP */
#popup{
  position:fixed;inset:0;
  background:rgba(0,0,0,.85);
  display:none;
  justify-content:center;
  align-items:center;
}
#popup div{
  background:#fff;
  padding:20px;
  border-radius:14px;
  max-width:400px;
  text-align:center;
}
</style>
</head>

<body>
<header>âš¡ POWER SHUTDOWN APP</header>

<div class="card">
  <button onclick="openPlan()">âž• Plan Shutdown (Admin)</button>
</div>

<div class="card">
  <h3>ðŸ“‹ Upcoming Plan Shutdown</h3>
  <table id="planTable"></table>
</div>

<!-- POPUP -->
<div id="popup">
  <div>
    <h2>ðŸ”” PLAN SHUTDOWN TOMORROW</h2>
    <p id="popText"></p>
    <button onclick="closePop()">OK</button>
  </div>
</div>

<script>
const  Plan WEBAPP_URL="https://script.google.com/macros/s/AKfycbw_UfJRIErdg8E3v6dYrc0rbJr9z9eHdK-yj9aZ-zIAo_DA86dJQiJ4EOSPWwFyvWvKaw/exec";
const Sheet2 CSV_URL="https://docs.google.com/spreadsheets/d/1NLMcoIjlo5elmrALUXPfvGOEqToS8tFPfGThRZ8maiU/export?format=csv";

function openPlan(){
  window.location.href = "?page=plan_entry";
}

google.script.run.withSuccessHandler(showPlans).getPlanList();
google.script.run.withSuccessHandler(showPopup).getTomorrowPlan();

function showPlans(data){
  var h="<tr><th>Date</th><th>Time</th><th>Feeder</th></tr>";
  data.forEach(r=>{
    h+=`<tr><td>${r[0]}</td><td>${r[1]}-${r[2]}</td><td>${r[3]}</td></tr>`;
  });
  document.getElementById("planTable").innerHTML=h;
}

function showPopup(r){
  if(!r) return;
  document.getElementById("popText").innerHTML=
    `Feeder : <b>${r[3]}</b><br>
     Time : ${r[1]} to ${r[2]}<br>
     Installation : ${r[4]}`;
  document.getElementById("popup").style.display="flex";
}
function closePop(){document.getElementById("popup").style.display="none";}
</script>
</body>
</html>
